<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Secure Banking Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<!-- QR libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}

body{
background:linear-gradient(135deg,#020617,#020617,#0f172a,#020617);
color:white;min-height:100vh;
}

/* HEADER */
.header{
display:flex;justify-content:space-between;align-items:center;
padding:18px 40px;background:rgba(255,255,255,0.05);
backdrop-filter:blur(15px);border-bottom:1px solid cyan;
}
.logo{font-size:26px;font-weight:700;color:cyan;text-shadow:0 0 15px cyan}

/* PROFILE */
.profile-container{
width:92%;margin:35px auto;padding:30px;border-radius:20px;
display:flex;justify-content:space-between;align-items:center;
background:rgba(255,255,255,0.05);
border:1px solid rgba(0,255,255,0.4);
box-shadow:0 0 30px rgba(0,255,255,0.3);
}
.profile-left{display:flex;align-items:center;gap:30px}

.big-circle{
width:130px;height:130px;border-radius:50%;border:3px solid cyan;
overflow:hidden;box-shadow:0 0 25px cyan;
}
.big-circle img{width:100%;height:100%;object-fit:cover}

.profile-info div{margin:6px 0;font-size:15px}
.profile-info i{color:cyan;margin-right:8px}

.profile-buttons button{
padding:12px 22px;margin:6px;border:none;border-radius:12px;
font-weight:600;cursor:pointer;background:linear-gradient(45deg,cyan,#00e5ff);
box-shadow:0 0 12px cyan;
}
.profile-buttons button:hover{transform:scale(1.07)}

.container{width:92%;margin:auto}

.actions{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
gap:20px;margin-top:40px;
}

.action{
padding:35px;text-align:center;border-radius:18px;cursor:pointer;
background:rgba(255,255,255,0.05);
border:1px solid cyan;transition:.3s;
font-size:18px;
}

.action:hover{
background:linear-gradient(45deg,cyan,#00e5ff);
color:black;transform:scale(1.05)
}

.action i{font-size:40px;margin-bottom:12px}

/* QR modal */
.qr-box{
position:fixed;
top:50%;left:50%;
transform:translate(-50%,-50%);
background:#020617;
border:2px solid cyan;
padding:25px;
border-radius:20px;
display:none;
z-index:999;
box-shadow:0 0 30px cyan;
text-align:center;
}

.qr-box input{
width:90%;
padding:12px;
margin:10px;
border-radius:10px;
border:none;
outline:none;
}

.qr-box button{
padding:10px 18px;
margin:10px;
border:none;
border-radius:10px;
background:cyan;
font-weight:600;
cursor:pointer;
}

#reader{width:300px;margin:auto}
</style>
</head>

<body>

<div class="header">
<div class="logo">üè¶ Secure Banking Dashboard</div>
</div>

<!-- PROFILE -->
<div class="profile-container">
<div class="profile-left">

<div class="big-circle">
<img id="profilePic" src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
</div>

<div class="profile-info">
<div><i class="bi bi-person-fill"></i> Name: <span id="dname">Loading...</span></div>
<div><i class="bi bi-person-fill"></i> Age: <span id="dage">Loading...</span></div>
<div><i class="bi bi-telephone-fill"></i> Phone: <span id="dphone">Loading...</span></div>
<div><i class="bi bi-envelope-fill"></i> Email: <span id="demail">Loading...</span></div>
<div><i class="bi bi-geo-alt-fill"></i> Address: <span id="daddress">Loading...</span></div>
</div>

</div>

<div class="profile-buttons">
<button onclick="openProfile()">Create/Edit</button>
<button onclick="logout()">Logout</button>
</div>
</div>

<div class="container">
<div class="actions">

<div class="action" onclick="openAccountPage()">
<i class="fa-solid fa-building-columns"></i><br>Account
</div>

<div class="action" onclick="openCheckBalance()">
<i class="bi bi-wallet2"></i><br>Check Balance
</div>

<div class="action" onclick="location='transfer.html'">
<i class="fa-solid fa-money-bill-transfer"></i><br>Transfer
</div>

<div class="action" onclick="openTransactions()">
<i class="fa-solid fa-clock-rotate-left"></i><br>Transactions
</div>

<div class="action" onclick="location='myqr.html'">
<i class="fa-solid fa-qrcode"></i><br>Generate QR
</div>

<!-- SCAN QR -->
<div class="action" onclick="location.href='scan.html'">
<i class="fa-solid fa-camera"></i><br>Scan QR
</div>

</div>
</div>

<!-- QR SCANNER BOX -->
<div class="qr-box" id="qrScanBox">
<h2>Scan QR</h2>
<div id="reader"></div>
<p id="scanResult"></p>
<button onclick="closeQR()">Close</button>
</div>

<script>
let token = localStorage.getItem("token");
let username = localStorage.getItem("username");

if(!token || !username){
alert("Session expired");
location="login.html";
}

window.onload=function(){
fetch("http://localhost:8080/profile/get/"+username,{
headers:{Authorization:"Bearer "+token}
})
.then(res=>res.json())
.then(p=>{
if(!p) return;
dname.innerText=p.name||"-";
dage.innerText=p.age||"-";
dphone.innerText=p.phone||"-";
demail.innerText=p.email||"-";
daddress.innerText=p.address||"-";
if(p.photo) profilePic.src=p.photo;
});
}

// pages
function openAccountPage(){ location="customeraccount.html"; }
function openProfile(){ location="profile.html"; }
function logout(){ localStorage.clear(); location="login.html"; }
function openCheckBalance(){ location="checkbalance.html"; }
function openTransactions(){ location="transactions.html"; }

//// QR SCANNER
let scanner;

function openQRScanner(){
document.getElementById("qrScanBox").style.display="block";

scanner = new Html5Qrcode("reader");

scanner.start(
{ facingMode: "environment" },
{ fps: 10, qrbox: 250 },
(qrCodeMessage)=>{

document.getElementById("scanResult").innerText="Scanned Account: "+qrCodeMessage;

// stop scanner
scanner.stop();

// save account number
localStorage.setItem("scanAccount", qrCodeMessage);

// open payment page
setTimeout(()=>{
window.location="scan.html";
},1000);

},
(errorMessage)=>{}
);
}

function closeQR(){
document.getElementById("qrScanBox").style.display="none";
if(scanner){scanner.stop();}
}
</script>

</body>
</html>







